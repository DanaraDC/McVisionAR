<html>
  <head>
    <script src="https://aframe.io/releases/1.6.0/aframe.min.js"></script>
  </head>
  <body>
    <a-scene>
      <a-assets>
        <a-asset-item
          id="burger"
          src="./../../../assets/models/burger/scene.gltf"></a-asset-item>
        <video
          id="videoFeed"
          autoplay
          playsinline
          muted
          crossorigin="anonymous"
          style="display: none"></video>
      </a-assets>

      <a-sky id="video-sky" material="shader: flat; src: #videoFeed"></a-sky>

      <a-entity
        gltf-model="#burger"
        position="0 1.5 -3"
        scale="0.05 0.05 0.05"></a-entity>

      <a-entity id="rig" position="0 1.6 0">
        <a-camera id="camera" look-controls wasd-controls></a-camera>
      </a-entity>

      <script>
        const videoElement = document.querySelector("#videoFeed");
        const videoSky = document.querySelector("#video-sky");

        function startVideo() {
          if (videoElement.readyState >= 3) {
            videoSky.setAttribute("material", "src", "#videoFeed");
            console.log("Video feed started.");
          } else {
            console.log("Waiting for video feed to start...");
            setTimeout(startVideo, 100);
          }
        }

        navigator.mediaDevices
          .getUserMedia({ video: true })
          .then((stream) => {
            videoElement.srcObject = stream;
            videoElement.onplaying = startVideo;
          })
          .catch((err) => {
            console.error("Error accessing the camera:", err);
          });
      </script>
    </a-scene>
  </body>
</html>
